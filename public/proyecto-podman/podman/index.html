<!DOCTYPE html>
<html lang="es-ES">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Podman | Blog</title>
  <meta name="description" content="En esta página estatica vamos a guardar algunos de los trabajos que vaya realizando a lo largo del curso de 2ºASIR en el instituto I.E.S. Gonzalo Nazareno.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Podman" />
<meta property="og:description" content="Contenedores podman En el siguiente post vamos a ver como podemos encontrar una alternativa a los contenedores Docker sin necesidad de tener que aprender nuevos comandos y sintaxis, para ello, la solución son los contenedores Podman
 Repositorio GitHub: https://github.com/FranJaviMN/Proyecto-integrado  ¿Qué son los contenedores Podman? Lo primero de lo que vamos a hablar es de donde surgio este motor de contenedores, sus caracteristicas mas representativas y las diferencias que podemos ver con su rival mas directo, Docker." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://franjavimn.onrender.com/proyecto-podman/podman/" /><meta property="article:section" content="Proyecto-podman" />
<meta property="article:published_time" content="2021-06-01T11:52:23&#43;02:00" />
<meta property="article:modified_time" content="2021-06-01T11:52:23&#43;02:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Podman"/>
<meta name="twitter:description" content="Contenedores podman En el siguiente post vamos a ver como podemos encontrar una alternativa a los contenedores Docker sin necesidad de tener que aprender nuevos comandos y sintaxis, para ello, la solución son los contenedores Podman
 Repositorio GitHub: https://github.com/FranJaviMN/Proyecto-integrado  ¿Qué son los contenedores Podman? Lo primero de lo que vamos a hablar es de donde surgio este motor de contenedores, sus caracteristicas mas representativas y las diferencias que podemos ver con su rival mas directo, Docker."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://franjavimn.onrender.com/css/style-white.css">
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://franjavimn.onrender.com/images/favicon.ico" />

  
</head>
<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="https://franjavimn.onrender.com">
  
    <div id="logo" style="background-image: url(https://franjavimn.onrender.com/images/logo.png)"></div>
  
  <div id="title">
    <h1>Blog</h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#"><i class="fas fa-bars fa-2x"></i></a>
      </li>
       
        <li><a href="/sistemas">Sistemas</a></li>
       
        <li><a href="/seguridad">Seguridad</a></li>
       
        <li><a href="/servicios">Servicios</a></li>
       
        <li><a href="/implantacion">Implantacion</a></li>
       
        <li><a href="/bbdd">BBDD</a></li>
       
        <li><a href="/hlc">HLC</a></li>
       
        <li><a href="/proyecto-podman">Proyecto Podman</a></li>
      
    </ul>
  </div>
</header>
  

    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="content" itemprop="articleBody">
  
    <h1 id="contenedores-podman">Contenedores podman</h1>
<p>En el siguiente post vamos a ver como podemos encontrar una alternativa a los contenedores <strong>Docker</strong> sin necesidad de tener que aprender nuevos comandos y sintaxis, para ello, la solución son los contenedores <strong>Podman</strong></p>
<ul>
<li>Repositorio GitHub: <a href="https://github.com/FranJaviMN/Proyecto-integrado">https://github.com/FranJaviMN/Proyecto-integrado</a></li>
</ul>
<h2 id="qué-son-los-contenedores-podman">¿Qué son los contenedores Podman?</h2>
<p>Lo primero de lo que vamos a hablar es de donde surgio este motor de contenedores, sus caracteristicas mas representativas y las diferencias que podemos ver con su rival mas directo, <strong>Docker</strong>.</p>
<p>Podman es la abreviatura de <em>Pod Manager</em> y fue desarrollado por la empresa <strong>Red Hat</strong> en el año 2018. Este motor fue diseñado en la experiencia de <strong>Docker</strong>, pero en un principio, <strong>Podman</strong> fue desarrollado como herramienta de depuración para <strong>CRI-O</strong>(infraestructura que usa kubernetes para usar cualquier tiempo de ejecución compatible con <strong>OCI</strong> como tiempo de ejecución del contenedor para ejecutar pods.) por lo que no estaba previsto que este fuera un nuevo motor de contenedores.</p>
<p>Este motor de contenedores <strong>Podman</strong> tiene una gran cantidad de similitudes con su competidor <strong>Docker</strong> e incluso, podemos encotrar gente que lo que realiza es una instalación de <strong>Podman</strong> en linux y a continuación crea un alias de esta forma:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">alias docker<span style="color:#f92672">=</span>podman
</code></pre></div><p>Obviamente es una broma que uno de los ingenrios de <strong>Red Hat</strong> hizo a la hora de prensentar <strong>Podman</strong> lo que nos hace entender que la migración a Podman es muy sencilla, ya que los ingenieros de RedHat han prestado especial atención en usar la misma nomenclatura a la hora de ejecutar comandos de Podman. Por lo que, si somos un usuario de Docker, ya conocemos la mayoría de los comandos en Podman. Así que, efectivamente, es tan sencillo como, en lugar de ejecutar <strong>docker run</strong>, ejecutar <strong>podman run</strong>, y el resultado será exactamente el mismo.</p>
<p>Por lo que vemos las diferencias que hay con <strong>Docker</strong> parecen ser minimas, pero su caracteristica mas representativa en lo liviano que es en comparación con <strong>Docker</strong> ya que <strong>Podman</strong>, carece de un <em>demonio central</em> para cada uno de los contenedores, en su lugar, han descentralizado todos los componentes necesarios para la gestión de contenedores y los han individualizado en componentes más pequeños que se utilizarán solo cuando sean necesarios. Esta descentralización nos ofrece un gran número de ventajas como el uso de esta herramienta sin la necesidad del uso del <strong>root</strong>.</p>
<h2 id="funciones-principales-de-podman">Funciones principales de Podman</h2>
<p>Ademas de que <strong>Podman</strong> no hace uso de un <em>demonio central</em>, otra caracterista muy importante de <strong>Podman</strong> es la posibilidad que tenemos de ejecutar <strong>pods</strong>(son la fusión de varios contenedores en un namespace común de Linux que comparten recursos concretos. De esta manera, se pueden combinar una amplia variedad de aplicaciones virtualizadas.) al igual que hacemos con <strong>Kubernetes</strong> porque, como bien hemos visto, principalmente se desarrolló teniendo en mente que estaria enfocado en <strong>Kubernetes</strong>. Por lo que vemos que con <strong>Podman</strong> podemos hacer todas las cosas que podemos hacer con <strong>Docker</strong> pero tambien nos brinda la posibilidad de la ejecución de <strong>pods</strong> como hacemos en <strong>Kubernetes</strong></p>
<p>Ademas, mencionado anteriormente, el uso de <strong>Podman no requiere privilegios de root por lo que puede ser ejecutado por un usuario normal</strong>. Aunque si es verdad que dentro de los contenedores de <strong>Podman</strong> todo y cada uno de los procesos <strong>se ejecutan bajo root</strong> y esto es posible ya que, podman hace uso de de los <strong>namespacede usuario del nucleo linux</strong>, que asigna privilegios especiales y un ID de usuario a los procesos. El hecho de que los contenedores en realidad se ejecuten como administrador dota al entorno virtualizado Podman de un elevado estándar de seguridad.</p>
<h2 id="introducción-a-podman">Introducción a Podman</h2>
<p>Visto todo lo que es <strong>Podman</strong> y sus caracteristicas, a continuación vamos a usarlo para ver su potencial, para ello vamos a hacer uso de una maquina virtual creada en <strong>Vagrant</strong> usando <strong>libvirt</strong>. El fichero <strong>Vagrantfile</strong> lo podemos encontrar a continuación:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># -*- mode: ruby -*-</span>
<span style="color:#75715e"># vi: set ft=ruby :</span>

<span style="color:#66d9ef">Vagrant</span><span style="color:#f92672">.</span>configure(<span style="color:#e6db74">&#34;2&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>podman<span style="color:#f92672">|</span>
  podman<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>box <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;generic/debian10&#34;</span>
  podman<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>hostname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;podman&#34;</span>
  podman<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>synced_folder <span style="color:#e6db74">&#34;.&#34;</span>, <span style="color:#e6db74">&#34;/vagrant&#34;</span>, <span style="color:#e6db74">disabled</span>: <span style="color:#66d9ef">true</span>
  podman<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>provider <span style="color:#e6db74">:libvirt</span> <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>libvirt<span style="color:#f92672">|</span>
    libvirt<span style="color:#f92672">.</span>uri <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;qemu+unix:///system&#39;</span>
    libvirt<span style="color:#f92672">.</span>host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;podman&#34;</span>
    libvirt<span style="color:#f92672">.</span>cpus <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    libvirt<span style="color:#f92672">.</span>memory <span style="color:#f92672">=</span> <span style="color:#ae81ff">512</span>
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>
</code></pre></div><p>Una vez desplegada nuestra maquina virtual ya podemos empezar a trastear con <strong>Podman</strong>.</p>
<h3 id="instalación-de-podman">Instalación de podman</h3>
<p>Lo primero que debemos de hacer, como es obvio, es instalar el motor de contenedores <strong>Podman</strong> en nuestra maquina virtual, para ello y, siguiendo la documentación oficial, vamos a instalarlo en nuestro sistema, en este caso <strong>Debian 10</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Debemos de habilitar en espacio de nombre de root ####</span>
echo <span style="color:#e6db74">&#39;kernel.unprivileged_userns_clone=1&#39;</span> &gt; /etc/sysctl.d/00-local-userns.conf
systemctl restart procps

<span style="color:#75715e">#### Añadimos los repositorios de backports de Debian 10 ####</span>
echo <span style="color:#e6db74">&#39;deb http://deb.debian.org/debian buster-backports main&#39;</span> &gt;&gt; /etc/apt/sources.list
echo <span style="color:#e6db74">&#39;deb https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable/Debian_10/ /&#39;</span> &gt; /etc/apt/sources.list.d/devel:kubic:libcontainers:stable.list

<span style="color:#75715e">#### Descargamos e instalamos la clave de los repositorios ####</span>
curl -L https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable/Debian_10/Release.key | sudo apt-key add -

<span style="color:#75715e">#### Actualizamos la lista de paquetes e instalamos dependencias desde backports ####</span>
sudo apt update
sudo apt -y -t buster-backports install libseccomp2

<span style="color:#75715e">#### Instalamos podman ####</span>
sudo apt -y install podman
</code></pre></div><p>Si nuestro sistema es diferente a <strong>Debian 10</strong> en la <a href="https://podman.io/getting-started/installation">documentación oficial</a> podemos encontrar la forma de instalarlo en nuestro sistema.</p>
<h3 id="primer-contenedor-podman-hello-world">Primer contenedor Podman: Hello-world</h3>
<p>Una vez ya tenemos instalado nuestro motor de contenedores, vamos a empezar a crear contenedores para ver su potencial y similitudes respecto a <strong>Docker</strong>.</p>
<p>Para ello vamos a hacer uso de la imagen llamada <strong>Hello-world</strong> que, por defecto, va a descargar desde <strong>docker.io</strong>.</p>
<p>Podemos hacerlo de dos maneras, o bien la descargamos antes de crear el contenedor o directamente creamos el contenedor y podman se encarga de buscar la imagen y bajarla para crear el contenedor:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Bajamos la imagen desde dockerhub en la ultima versión ####</span>
root@podman:~# podman pull hello-world:latest
Resolved <span style="color:#e6db74">&#34;hello-world&#34;</span> as an alias <span style="color:#f92672">(</span>/etc/containers/registries.conf.d/000-shortnames.conf<span style="color:#f92672">)</span>
Trying to pull docker.io/library/hello-world:latest...
Getting image source signatures
Copying blob b8dfde127a29 <span style="color:#66d9ef">done</span>  
Copying config d1165f2212 <span style="color:#66d9ef">done</span>  
Writing manifest to image destination
Storing signatures
d1165f2212346b2bab48cb01c1e39ee8ad1be46b87873d9ca7a4e434980a7726

<span style="color:#75715e">#### Creamos el contenedor ####</span>
root@podman:~# podman run hello-world

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
...
</code></pre></div><p>Una vez hemos creado la imagen debe de salirnos algo como lo anterior que, aunque ponga <em>hello from docker</em> estamos haciendo uso de <strong>Podman</strong>. Ahora que hemos creado el contenedor vamos a listar los contenedores para ver el que hemos creado:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Listamos los contenedores en ejecución ####</span>
podman:~# podman ps
CONTAINER ID  IMAGE   COMMAND  CREATED  STATUS  PORTS   NAMES

<span style="color:#75715e">#### Listamos todos los contenedores ####</span>
root@podman:~# podman ps -a
CONTAINER ID  IMAGE                                 COMMAND  CREATED        STATUS                    PORTS   NAMES
6f3fb0ecd405  docker.io/library/hello-world:latest  /hello   <span style="color:#ae81ff">3</span> minutes ago  Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">3</span> minutes ago          nifty_franklin
</code></pre></div><p>Comprobamos que este contenedor no se está ejecutando. <strong>Un contenedor ejecuta un proceso y cuando termina la ejecución, el contenedor se para.</strong></p>
<p>Si queremos eliminar un contenedor que tenemos creado, es importante saber que debe de estar inactivo antes de poder eliminarlo, de lo contrario no nos dejara eliminar dicho contenedor:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Paramos el contenedor si estviera en ejecución ####</span>
root@podman:~# podman stop 6f3fb0ecd405
6f3fb0ecd4053de87eda0644f54e0d1ebe86c0bd020f3c6a16e8d2150114e3fe

<span style="color:#75715e">#### Lo borramos ####</span>
root@podman:~# podman rm 6f3fb0ecd405
6f3fb0ecd4053de87eda0644f54e0d1ebe86c0bd020f3c6a16e8d2150114e3fe
</code></pre></div><p>Si queremos saber mas acerca de <strong>Podman</strong> podemos seguir los post que tengo en esta misma pagina sobre <strong>Docker</strong> que si bien esta enfocado a Docker, hemos visto que sus comandos son los mismos y sus funciones tambien lo son, por lo que solo debemos de cambiar la palabra <em>Docker</em> por la palabra <em>Podman</em>:</p>
<ul>
<li>
<p>Introducción a Docker: <a href="https://franjavimn.onrender.com/implantacion/introduccion-docker/">https://franjavimn.onrender.com/implantacion/introduccion-docker/</a></p>
</li>
<li>
<p>Almacenamiento en Docker: <a href="https://franjavimn.onrender.com/implantacion/almacenamiento-docker/">https://franjavimn.onrender.com/implantacion/almacenamiento-docker/</a></p>
</li>
</ul>
<h2 id="pods-con-podman">Pods con Podman</h2>
<h3 id="qué-es-un-pod">¿Qué es un Pod?</h3>
<p>Antes de empezar vamos a ver que es un pod.</p>
<p>Debemos de tener en cuneta que los pods es un concepto que introdució Kubernetes pero el concepto en Podman es muy similar al que maneja Kubernetes. Un Pod (como en una vaina de ballenas o vaina de guisantes) es un grupo de uno o más contenedores (como contenedores Docker o Podman), con almacenamiento/red compartidos, y unas especificaciones de cómo ejecutar los contenedores. Los contenidos de un Pod son siempre coubicados, coprogramados y ejecutados en un contexto compartido y este contiene uno o más contenedores de aplicaciones relativamente entrelazados.</p>
<p>El contexto compartido de un Pod es un conjunto de namespaces de Linux, cgroups y, potencialmente, otras facetas de aislamiento, las mismas cosas que aíslan un contenedor Docker o Podman. Dentro del contexto de un Pod, las aplicaciones individuales pueden tener más subaislamientos aplicados. Los contenedores dentro de un Pod comparten dirección IP y puerto, y pueden encontrarse a través de localhost. También pueden comunicarse entre sí mediante comunicaciones estándar entre procesos. Los contenedores en diferentes Pods tienen direcciones IP distintas y no pueden comunicarse por IPC sin configuración especial. Estos contenedores normalmente se comunican entre sí a través de las direcciones IP del Pod.</p>
<p>En términos de Docker, un Pod se modela como un grupo de contenedores de Docker con namespaces y volúmenes de sistemas de archivos compartidos.</p>
<p><img src="https://raw.githubusercontent.com/FranJaviMN/elementos-grado/a7c12c4da2fedd5e8a4c7f5bd9ddc2b01dab9774/Proyecto/pod.svg" alt="Imagen de un pod"></p>
<p>Un Pod de múltiples contenedores que contiene un extractor de archivos y un servidor web que utiliza un volumen persistente para el almacenamiento compartido entre los contenedores.</p>
<h2 id="concepto-de-pod-en-podman">Concepto de pod en Podman</h2>
<p>Ahora, si hablamos de los Pods en Podman los cuales, son similares al concepto que tiene Kubernetes sobre estos, podemos fijarnos en este esquema:</p>
<p><img src="https://raw.githubusercontent.com/FranJaviMN/elementos-grado/main/Proyecto/podman-pod-architecture.png" alt="Pods en podman"></p>
<p>Todos los pods que vamos a crear con Podman vamos a tener un container &ldquo;<em>Infra</em>&rdquo;. Este contenedor no hace nada. El proposito es el de sostener los <em>namespaces</em> asociados en el pod y permite que podman conecte con otros contenedores del pod. Esto le permite iniciar y detener contenedores dentro del pod y el pod seguirá funcionando donde, si el contenedor primario controlara el pod, esto no sería posible. Por defecto, el contenedor &ldquo;<em>infra</em>&rdquo; esta basado en la imagen <strong>k8s.gcr.io/pause</strong>. A menos que diga explícitamente lo contrario, todos los pods tendrán un contenedor basado en la imagen predeterminada.</p>
<h2 id="cli-podman-pod">CLI: podman pod</h2>
<p>Para ello vamos a tener la siguiente guia sobre los comandos:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Comando por defecto para tratar con pods en podman ####</span>

podman pod - Gestiona los pods.

Los pods son un grupo de uno o varios contenedores compartiendo la misma red, PID y espacio de nombres.

USO:
  podman pod comando <span style="color:#f92672">[</span>comando opciones<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>argumentos...<span style="color:#f92672">]</span>

COMANDOS:
  create        Crea un nuevo pod vacio.
  exists        Comprueba si el pod existe
  inspect       Saca por pantalla la información acerca del pod
  kill          Envia una señal <span style="color:#e6db74">&#34;kill&#34;</span> al pod
  pause         Pausa uno o mas pods
  ps, ls, list  Lista los pods 
  restart       Reinicia uno o mas pods
  rm            Elimina uno o mas pods
  start         Inicia uno o mas pods
  stats         Saca por pantalla el consumo de CPU, memory, network I/O, block I/O and PIDs de los contenedores en uno o mas pods
  stop          Para uno o mas pods
  top           muestra por pantalla los procesos de los contenedores en un pod
  unpause       Quita de pausa uno o mas pods

OPCIONES:
  --help, -h Muestra las opciones de los comandos. Ej: podman pod create --help
</code></pre></div><h3 id="creación-de-pods">Creación de pods</h3>
<p>La manera mas sencilla que tenemos con podman para crear un pod, como hemos visto en los comandos anteriores, es usando <strong>podman pod create</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">
<span style="color:#75715e">#### Comando para la creación de pods ####</span>

podman pod create - Crea un nuevo pod vacio

USO: 
  podman pod create <span style="color:#f92672">[</span>comando opciones<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>argumentos...<span style="color:#f92672">]</span>

OPCIONES:
  --cgroup-parent <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>      Set parent cgroup <span style="color:#66d9ef">for</span> the pod
  --infra                    Crea un contenedor infra en el nuevo pod
  --infra-command <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>      Comando que se va a ejecutar en el contenedor infra cuando el pod se inicie <span style="color:#f92672">(</span>default: <span style="color:#e6db74">&#34;/pause&#34;</span><span style="color:#f92672">)</span>
  --infra-image <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>        Le indicamos cual es la imagen del contendor <span style="color:#e6db74">&#34;infra&#34;</span> que va a usar <span style="color:#f92672">(</span>Por defecto: <span style="color:#e6db74">&#34;k8s.gcr.io/pause:3.1&#34;</span><span style="color:#f92672">)</span>
  --label <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>, -l <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>    Fija los metadatos en el pod <span style="color:#f92672">(</span>default <span style="color:#f92672">[])</span>
  --label-file <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>         Lee en un archivo las etiquetas delimitadas por lineas <span style="color:#f92672">(</span>default <span style="color:#f92672">[])</span>
  --name <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>, -n <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>     Asigan un nombre al contenedor, si no se le añade, le da uno aleatorio
  --pod-id-file <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>        Inyecta el ID del pod en un fichero
  --publish <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>, -p <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>  Indicamos puertos o un rango de puertos en el host <span style="color:#f92672">(</span>default <span style="color:#f92672">[])</span>
  --share <span style="color:#f92672">[</span>value<span style="color:#f92672">]</span>              Una lista de los namespaces que el pod va a usar, separado por comas <span style="color:#f92672">(</span>default: <span style="color:#e6db74">&#34;cgroup,ipc,net,uts&#34;</span><span style="color:#f92672">)</span>
</code></pre></div><p>Ahora que hemos visto un poco las opciones que ofrece podman para crear pods, vamos a empezar por lo mas basico que es la creacion de un pod &ldquo;vacio&rdquo; para ir viendo todo lo que podemos ir haciendo con este pod.</p>
<p>Lo primero que debemos de hacer es crear el pod, que le vamos a da un nombre concreto, para ello vamos a usar el siguiente comando:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Creamos el pod con el nombre &#34;pod_prueba&#34; ####</span>
vagrant@podman:~$ podman pod create --name pod_prueba
b11f104a9e60af2339f297cd33ba008239b3c4c8e91ba041a61386b35ecf968d
</code></pre></div><p>Como vemos, al crear tambien nos saca por pantalla el id de ese pod que tambien podriamos usar a parte del nombre que le hemos pues al pod. Ahora mismo este pod que hemos creado esta vacio y, como hemos visto anteriormente, solo contiene el contenedor &ldquo;infra&rdquo;:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Listamos los pods que tenemos creados  ####</span>
vagrant@podman:~$ podman pod list
POD ID        NAME        STATUS   CREATED         INFRA ID      <span style="color:#75715e"># OF CONTAINERS</span>
b11f104a9e60  pod_prueba  Created  <span style="color:#ae81ff">35</span> seconds ago  50747b98c542  <span style="color:#ae81ff">1</span>

<span style="color:#75715e">#### Comprobamos los contenedores que tenemos dentro del pod ####</span>
vagrant@podman:~$ podman ps -a --pod
CONTAINER ID  IMAGE                 COMMAND  CREATED         STATUS   PORTS   NAMES               POD ID        PODNAME
50747b98c542  k8s.gcr.io/pause:3.2           <span style="color:#ae81ff">52</span> seconds ago  Created          b11f104a9e60-infra  b11f104a9e60  pod_prueba
</code></pre></div><h3 id="añadir-nuevos-contenedores-a-un-pod">Añadir nuevos contenedores a un Pod</h3>
<p>Visto la creacion de un pod &ldquo;vacio&rdquo; ahora vamos a proceder a añadir un contenedor a este pod, para ello debemos de tener claro a que pod vamos a agregar el nuevo contenedor por lo que, o bien usamos el id del pod o usamos su nombre.</p>
<p>En estos ejemplos vamos a añadir un nuevo contenedor que va a correr con una imagen de debian 10 y como proceso va a correr un &ldquo;top&rdquo; y un &ldquo;ls&rdquo;:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Creamos un contenedor en el pod de &#34;prueba_pod ####</span>
vagrant@podman:~$ podman run -dt --pod b11f104a9e60 docker.io/library/alpine:latest top
2a67924007260c8f663fda6bd7734b098e317774b6f59fa2e57cadef9b48ab01

<span style="color:#75715e">#### Listamos los contenedores del pod ####</span>
vagrant@podman:~$ podman ps -a --pod
CONTAINER ID  IMAGE                            COMMAND  CREATED             STATUS                    PORTS   NAMES                 POD ID        PODNAME
50747b98c542  k8s.gcr.io/pause:3.2                      About a minute ago  Up <span style="color:#ae81ff">18</span> seconds ago                 b11f104a9e60-infra    b11f104a9e60  pod_prueba
2a6792400726  docker.io/library/alpine:latest  top      <span style="color:#ae81ff">18</span> seconds ago      Up <span style="color:#ae81ff">17</span> seconds ago                 recursing_pascal      b11f104a9e60  pod_prueba
</code></pre></div><p>Como vemos tenemos el nuevo contenedor en el pod, con un nombre aleatorio y se esta ejecutando el comando top, que nos muestra los procesos y carga de la maquina por lo que el contenedor se va a quedar levantado hasta que yo le diga lo contrario.</p>
<p>En cambio si lanzamos un contenedor en el pod que solo ejecute un &ldquo;ls&rdquo; veremos que al instante el contenedor se para y ya no esta en funcionamiento porque los contenedores solo ejecutan un proceso, cuando este termina, el contenedor se para ya que estos son efimeros:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Creamos un contenedor con debian y ejecutamos &#34;ls&#34; ####</span>
vagrant@podman:~$ podman run -dt --pod b11f104a9e60 docker.io/library/debian:latest ls
3a6171279b402b588a952f277a8e19efab390c0b39441742f9c0b09e9626ce54

<span style="color:#75715e">#### Comprobamos los contenedores de pod ####</span>
vagrant@podman:~$ podman ps -a --pod
CONTAINER ID  IMAGE                            COMMAND  CREATED             STATUS                    PORTS   NAMES                 POD ID        PODNAME
50747b98c542  k8s.gcr.io/pause:3.2                      About a minute ago  Up <span style="color:#ae81ff">18</span> seconds ago                 b11f104a9e60-infra    b11f104a9e60  pod_prueba
2a6792400726  docker.io/library/alpine:latest  top      <span style="color:#ae81ff">18</span> seconds ago      Up <span style="color:#ae81ff">17</span> seconds ago                 recursing_pascal      b11f104a9e60  pod_prueba
3a6171279b40  docker.io/library/debian:latest  ls       <span style="color:#ae81ff">3</span> seconds ago       Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">3</span> seconds ago          ecstatic_stonebraker  b11f104a9e60  pod_prueba
</code></pre></div><p>Como vemos, se ha creado y al tiempo de terminar el proceso de ls, este contenedor se ha parado.</p>
<h3 id="creando-escenarios-con-pods">Creando escenarios con pods</h3>
<p>Ahora que hemos visto como crear pods y la forma de poder agregar a estos distintos contenedores que nosotros creemos, vamos a empezar a crear escenarios sencillos con pods y con algunos contenedores.</p>
<ul>
<li>
<p>El primero ejemplo que vamos a hacer va a ser un clásico, un pod con dos contenedores, uno con un contenedores que contenga un wordpress y otro contenedor con la base de datos, en este caso va a ser una base de datos MySQL.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Creamos el pod que tendra de nombre &#34;servidor-wp&#34; ####</span>
vagrant@podman:~$ podman pod create --name servidor-wp -p 8080:80

<span style="color:#75715e">#### Una vez creado vamos a generar un contenedor que sera la base de datos ####</span>
vagrant@podman:~$ podman run -d --restart<span style="color:#f92672">=</span>always --pod<span style="color:#f92672">=</span>servidor-wp -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;wp-password&#34;</span> -e MYSQL_DATABASE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;wp&#34;</span> -e MYSQL_USER<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;wordpress&#34;</span> -e MYSQL_PASSWORD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;user-password&#34;</span>  --name<span style="color:#f92672">=</span>mysql-wp mariadb

<span style="color:#75715e">#### Creamos por ultimo el contenedor con wordpress ####</span>
vagrant@podman:~$ podman run -d --restart<span style="color:#f92672">=</span>always --name<span style="color:#f92672">=</span>mywordpress --pod<span style="color:#f92672">=</span>19b301d2965b -e WORDPRESS_DB_NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;wp&#34;</span> -e WORDPRESS_DB_USER<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;wordpress&#34;</span> -e WORDPRESS_DB_PASSWORD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;user-password&#34;</span> -e   WORDPRESS_DB_HOST<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;127.0.0.1&#34;</span> wordpress

<span style="color:#75715e">#### Comprobamos que tenemos 3 contenedores en un mismo pod, el contenedor infra, wordpress y mysql ####</span>
vagrant@podman:~$ podman ps -a --pod
CONTAINER ID  IMAGE                               COMMAND               CREATED        STATUS            PORTS                 NAMES                     POD ID        PODNAME
e86e5dd06397  k8s.gcr.io/pause:3.2                                      <span style="color:#ae81ff">5</span> minutes ago  Up <span style="color:#ae81ff">5</span> minutes ago  0.0.0.0:8080-&gt;80/tcp  294226c2dbf3-infra        294226c2dbf3  servidor-wp
d0c06bdf6d54  docker.io/library/wordpress:latest  apache2-foregroun...  <span style="color:#ae81ff">5</span> minutes ago  Up <span style="color:#ae81ff">5</span> minutes ago  0.0.0.0:8080-&gt;80/tcp  servidor-wp-my-wordpress  294226c2dbf3  servidor-wp
f51e666c6cce  docker.io/library/mariadb:latest    mysqld                <span style="color:#ae81ff">5</span> minutes ago  Up <span style="color:#ae81ff">5</span> minutes ago  0.0.0.0:8080-&gt;80/tcp  servidor-wp-mysql-wp      294226c2dbf3  servidor-wp
</code></pre></div><p>Como hemos visto en este ejemplo, hemos creado un pod con un escenario de una base de datos y un wordpress escuchando en el puerto 80, que ha sido redireccionado al puerto 8080 del pod, por lo  que, si queremos entrar en ese wordpress que hemos creado solo bastaria con averiguar la ip de la maquina donde se encuentra ese pod, en este caso la ip es <strong>192.168.121.207</strong> y en el navegador  entrar en esa ip pero en el puerto 8080:</p>
<p><img src="https://raw.githubusercontent.com/FranJaviMN/elementos-grado/main/Proyecto/captura-wp-podman.png" alt="Imagen wordpress pod"></p>
<p>Vemos que funciona perfectamente pero, ¿Y si quisieramos llevarnos este escenario a otro entorno de podman o un entorno de Kubernetes? Para ello podman tiene una funcion llamada <strong>generate</strong> el cual nos va a generar un fichero <strong>.yaml</strong> el cual se lo podemos pasar como parametro a podman o a kuberntes. Para generar este fichero .yaml podemos usar el siguiente comando:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Generamos el fichero .yaml ####</span>
vagrant@podman:~$ podman generate kube servidor-wp &gt;&gt; escenario-wp.yaml

<span style="color:#75715e">#### Si queremos ejecutar este fichero con podman para que genere el escernario ####</span>
vagrant@podman:~$ podman play kube ./escenario-wp.yaml
</code></pre></div><p>Nos habra generado un <a href="https://github.com/FranJaviMN/Proyecto-integrado/blob/main/podman/escenario-worpress/escenario-wp.yaml">fichero como este</a></p>
<ul>
<li>En nuestro segundo ejemplo vamos a crear nuestra propia imagen haciendo uso de buildah y con ella vamos a crear, al igual que en el anterior ejemplo, un escenario con dos contenedores en un pod.</li>
</ul>
<p>Para ello vamos a hacer uso del siguiente fichero <strong>Dockerfile</strong> el cual vamos a usar con buildah para generar la imagen:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> debian</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> apt-get update <span style="color:#f92672">&amp;&amp;</span> apt-get install -y apache2 libapache2-mod-php7.3 php7.3 php7.3-mysql <span style="color:#f92672">&amp;&amp;</span> apt-get clean <span style="color:#f92672">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> rm /var/www/html/index.html<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> APACHE_SERVER_NAME<span style="color:#f92672">=</span>www.bookmedik-francisco.org<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> DATABASE_USER<span style="color:#f92672">=</span>bookmedik
<span style="color:#66d9ef">ENV</span> DATABASE_PASSWORD<span style="color:#f92672">=</span>bookmedik
<span style="color:#66d9ef">ENV</span> DATABASE_HOST<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span>.0.0.1<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">EXPOSE</span><span style="color:#e6db74"> 80</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> ./bookmedik /var/www/html<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ADD</span> script.sh /usr/local/bin/script.sh<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> chmod +x /usr/local/bin/script.sh<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;/usr/local/bin/script.sh&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Creamos un nuevo pod llamado bookmedik ####</span>
vagrant@podman:~$ podman pod create --name bookmedik -p 8082:80

<span style="color:#75715e">#### Creamos la nueva imagen con la app de bookmedik ####</span>
vagrant@podman:~/Proyecto-integrado/podman/escenario-bookmedik/Build$ buildah bud -f Dockerfile -t bookmedik-podman

<span style="color:#75715e">#### Generamos el contenedor con la base de datos ####</span>
vagrant@podman:~$ podman run -d --restart<span style="color:#f92672">=</span>always --pod<span style="color:#f92672">=</span>bookmedik -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;franciscojavier&#34;</span> -e MYSQL_DATABASE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bookmedik&#34;</span> -e MYSQL_USER<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bookmedik&#34;</span> -e MYSQL_PASSWORD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bookmedik&#34;</span>  --name<span style="color:#f92672">=</span>mysql-bookmedik mariadb

<span style="color:#75715e">#### Generamos el contenedor con la imagen que hemos creado anteriormente ####</span>
vagrant@podman:~$ podman run -d --restart<span style="color:#f92672">=</span>always --pod<span style="color:#f92672">=</span>bookmedik --name<span style="color:#f92672">=</span>bookmedik-app localhost/bookmedik-podman

<span style="color:#75715e">#### Comprobamos que tenemos un pod con 3 contenedores, mysql, bookmedik y el contenedor infra ####</span>
vagrant@podman:~$ podman ps -a --pod
CONTAINER ID  IMAGE                             COMMAND               CREATED      STATUS          PORTS                 NAMES               POD ID        PODNAME
cdbff5cd897d  k8s.gcr.io/pause:3.2                                    <span style="color:#ae81ff">2</span> hours ago  Up <span style="color:#ae81ff">2</span> hours ago  0.0.0.0:8082-&gt;80/tcp  aed61cb395da-infra  aed61cb395da  bookmedik
093135c6f6bf  localhost/bookmedik-podman        /usr/local/bin/sc...  <span style="color:#ae81ff">2</span> hours ago  Up <span style="color:#ae81ff">2</span> hours ago  0.0.0.0:8082-&gt;80/tcp  bookmedik-app       aed61cb395da  bookmedik
557d0f451949  docker.io/library/mariadb:latest  mysqld                <span style="color:#ae81ff">2</span> hours ago  Up <span style="color:#ae81ff">2</span> hours ago  0.0.0.0:8082-&gt;80/tcp  mysql-bookmedik     aed61cb395da  bookmedik
</code></pre></div><p>Una vez hayamos creado el pod con los 3 contenedores necesitamos cargar en la base de datos de nuestro contenendor <strong>mysql-bookmedik</strong> los datos para poder usar la app de bookmedik, para ello debemos de cargar el <a href="https://github.com/FranJaviMN/Proyecto-integrado/blob/main/podman/escenario-bookmedik/Build/bookmedik/schema.sql">fichero siguiente</a> en la base de datos.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Cargamos el fichero .sql en la base de datos de nuestro contenedor mysql-bookmedik ####</span>
vagrant@podman:~$ cat schema.sql | podman exec -i mysql-bookmedik /usr/bin/mysql -u root --password<span style="color:#f92672">=</span>franciscojavier bookmedik
</code></pre></div><p>Una vez tengamos ya la base de datos entramos en <strong>IP:8082</strong> y como datos de acceso es usuario: admin y contraseña:admin y debemos de tener lo siguiente:</p>
<p><img src="https://raw.githubusercontent.com/FranJaviMN/elementos-grado/main/Proyecto/captura-bookmedik.podman.png" alt="imagen de bookmedik"></p>
</li>
</ul>
<h2 id="podman-compose">Podman-compose</h2>
<p>Al igual que con los contenedores Docker tenemos la herramienta de <strong>docker-compose</strong> que nos permite desplegar escenarios de contenedores mediante un fichero .yaml, todo lo relacionado con docker-compose lo tengo explicado en una <a href="https://franjavimn.onrender.com/implantacion/docker-compose/">entrada de mi Blog</a>.</p>
<p>Pues con los contenedores podman tenemos la misma herramienta que con Docker pero de nombre <strong>podman-compose</strong> que, al igual que <strong>docker-compose</strong>. no permite desplegar escenarios desde un fichero .yaml lo cual es muy interesante pero esta herramienta es un poco distinta a la hora de desplegar los escenarios ya que esta usa la utilidad de podman de crear pods con varios contenedores por lo que, al usar podman-compose estamos generando un pod con distintos contenedores en su interior.</p>
<p>Podman-compose es un proyecto que es definido por sus propios desarrolladores como <strong>un script para usar ficheros docker-compose.yml con podman</strong>. La instalación se puede hacer de distintas maneras y podemos ver las distintas formas de instalar este herramienta en multiples distribuciones de linux, asi bien, yo lo instalare en una maquina con Debian 10, lo podemos ver <a href="https://github.com/containers/podman-compose">aqui</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### En una maquina Debian 10 instalamos lass herramientas para manejar paquetes python ####</span>
vagrant@podman:~$ sudo apt install python3-pip

<span style="color:#75715e">#### Una vez instalados, instalamos las dependencias de podman-compose ####</span>
vagrant@podman:~$ pip3 install pyaml
Collecting pyaml

<span style="color:#75715e">#### Instalamos desde los repositorios de git el paquete de podman-compose ####</span>
vagrant@podman:~$ pip3 install https://github.com/containers/podman-compose/archive/devel.tar.gz
</code></pre></div><p>Una vez tengamos hecho esto solo debemos de empezar a crear ficheros docker-compose para ejecutarlos con nuestra herramienta de <strong>podman-compose</strong>. Ademas de que esta herramienta es uy util, tambien tenemos una ayuda muy completa a nuestro alcance, para ello solo debemos de seguir los pasos siguientes:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">vagrant@podman:~/.local/bin$ ./podman-compose --help
usage: podman-compose <span style="color:#f92672">[</span>-h<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-f file<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-p PROJECT_NAME<span style="color:#f92672">]</span>
                      <span style="color:#f92672">[</span>--podman-path PODMAN_PATH<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--podman-args args<span style="color:#f92672">]</span>
                      <span style="color:#f92672">[</span>--podman-pull-args args<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--podman-push-args args<span style="color:#f92672">]</span>
                      <span style="color:#f92672">[</span>--podman-build-args args<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--podman-inspect-args args<span style="color:#f92672">]</span>
                      <span style="color:#f92672">[</span>--podman-run-args args<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--podman-start-args args<span style="color:#f92672">]</span>
                      <span style="color:#f92672">[</span>--podman-stop-args args<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--podman-rm-args args<span style="color:#f92672">]</span>
                      <span style="color:#f92672">[</span>--podman-volume-args args<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--no-ansi<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--no-cleanup<span style="color:#f92672">]</span>
                      <span style="color:#f92672">[</span>--dry-run<span style="color:#f92672">]</span>
                      <span style="color:#f92672">[</span>-t <span style="color:#f92672">{</span>1pod,1podfw,hostnet,cntnet,publishall,identity<span style="color:#f92672">}]</span>
                      <span style="color:#f92672">{</span>help,version,pull,push,build,up,down,ps,run,exec,start,stop,restart,logs<span style="color:#f92672">}</span>
                      ...

optional arguments:
  -h, --help            show this help message and exit
  -f file, --file file  Specify an alternate compose file <span style="color:#f92672">(</span>default: docker-
                        compose.yml<span style="color:#f92672">)</span>
  -p PROJECT_NAME, --project-name PROJECT_NAME
                        Specify an alternate project name <span style="color:#f92672">(</span>default: directory
                        name<span style="color:#f92672">)</span>
  --podman-path PODMAN_PATH
                        Specify an alternate path to podman <span style="color:#f92672">(</span>default: use
                        location in $PATH variable<span style="color:#f92672">)</span>
  --podman-args args    custom global arguments to be passed to <span style="color:#e6db74">`</span>podman<span style="color:#e6db74">`</span>
  --podman-pull-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman pull<span style="color:#e6db74">`</span>
  --podman-push-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman push<span style="color:#e6db74">`</span>
  --podman-build-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman build<span style="color:#e6db74">`</span>
  --podman-inspect-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman inspect<span style="color:#e6db74">`</span>
  --podman-run-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman run<span style="color:#e6db74">`</span>
  --podman-start-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman start<span style="color:#e6db74">`</span>
  --podman-stop-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman stop<span style="color:#e6db74">`</span>
  --podman-rm-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman rm<span style="color:#e6db74">`</span>
  --podman-volume-args args
                        custom arguments to be passed to <span style="color:#e6db74">`</span>podman volume<span style="color:#e6db74">`</span>
  --no-ansi             Do not print ANSI control characters
  --no-cleanup          Do not stop and remove existing pod &amp; containers
  --dry-run             No action; perform a simulation of commands
  -t <span style="color:#f92672">{</span>1pod,1podfw,hostnet,cntnet,publishall,identity<span style="color:#f92672">}</span>, --transform_policy <span style="color:#f92672">{</span>1pod,1podfw,hostnet,cntnet,publishall,identity<span style="color:#f92672">}</span>
                        how to translate docker compose to podman
                        <span style="color:#f92672">[</span>1pod|hostnet|accurate<span style="color:#f92672">]</span>

command:
  <span style="color:#f92672">{</span>help,version,pull,push,build,up,down,ps,run,exec,start,stop,restart,logs<span style="color:#f92672">}</span>
    help                show help
    version             show version
    pull                pull stack images
    push                push stack images
    build               build stack images
    up                  Create and start the entire stack or some of its
                        services
    down                tear down entire stack
    ps                  show status of containers
    run                 create a container similar to a service to run a one-
                        off command
    exec                execute a command in a running container
    start               start specific services
    stop                stop specific services
    restart             restart specific services
    logs                show logs from services
</code></pre></div><p>Para usar la herramienta solo debemos de tener un fichero llamado <strong>docker-compose.yml</strong>. Para ello vamos a usar como prueba el siguiente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-dockerfile" data-lang="dockerfile">version: <span style="color:#e6db74">&#34;3.8&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>services: <span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  wordpress:<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    <span style="color:#75715e">#Nomber del contenedor</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    container_name: servidor_wp<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    <span style="color:#75715e">#Imagen que vamos a usar</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    image: wordpress<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    <span style="color:#75715e">#Indicamos la política de reinicio del contenedor si por cualquier condición se para</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    restart: always<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    <span style="color:#75715e">#Definimos las variables de entorno que nos ofrecen en la documentacion de wordpress</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    environment:<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      WORDPRESS_DB_HOST: db<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      WORDPRESS_DB_USER: user_wp<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      WORDPRESS_DB_PASSWORD: asdasd<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      WORDPRESS_DB_NAME: bd_wp<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    <span style="color:#75715e">#Puertos que vamos a exponer de nuestra maquina y el contenedor  </span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    ports:<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      - 8080:80<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  db:<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    container_name: servidor_mysql<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    image: mariadb<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    restart: always<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    environment:<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      MYSQL_DATABASE: bd_wp<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      MYSQL_USER: user_wp<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      MYSQL_PASSWORD: asdasd<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>      MYSQL_ROOT_PASSWORD: asdasd<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Tras esto solo debemos de ejecutar el script de <strong>podman-compose</strong> para que lea el fichero y cree el escenario mediante este. Si vemos un poco mas detenidamente las opciones que nos ofrece este script, veremos que podemos indicarle mediante el la opción <em>-t</em> que nos va a permitir indicarle como queremos pasar el fichero de <strong>Docker-compose</strong> a podman y podemosdecirle que lo cree todo en un mismo pod con el parametro <strong>1podfw</strong>, asi, usando el siguiente comando vamos a generar el escenario:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Ejecutamos el script de podman-compose ####</span>
vagrant@podman:~/.local/bin$ ./podman-compose -t 1podfw -p wp_compose -f /home/vagrant/Proyecto-integrado/podman/podman-compose/docker-compose.yml up 

Indicando:
  -t: Forma de interpretar el fichero docker-compose, en este caso, crear un solo pod
  -p: Nombre del proyecto, es decir, del pod que vamos a crear
  -f: Le indicamos la ruta del fichero de docker-compose
  up: Indicamos que levante el escenario
</code></pre></div><p>Tambien podemos usar la opcion llamada <strong>&ndash;dry-run</strong> que nos muestra por pantalla los comandos que usa podman-compose para la creación del escenario a partir del fichero de docker-compose como podemos ver en el siguiente ejemplo:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#### Ejecutamos el script de podman-compose ####</span>
vagrant@podman:~/.local/bin$ ./podman-compose -t 1podfw -p wp_compose --dry-run -f /home/vagrant/Proyecto-integrado/podman/podman-compose/docker-compose.yml up 

<span style="color:#75715e">#### Vemos como nos da los comando para la creación del escenario a mano ####</span>
<span style="color:#75715e"># POD</span>
podman pod create --name<span style="color:#f92672">=</span>wp_compose --share net -p 8080:80

<span style="color:#75715e"># Wordpress</span>
podman create --name<span style="color:#f92672">=</span>servidor_wp --pod<span style="color:#f92672">=</span>wp_compose --label io.podman.compose.config-hash<span style="color:#f92672">=</span><span style="color:#ae81ff">123</span> --label io.podman.compose.project<span style="color:#f92672">=</span>wp_compose --label io.podman.compose.version<span style="color:#f92672">=</span>0.0.1 --label com.docker.compose.project<span style="color:#f92672">=</span>wp_compose --label com.docker.compose.project.working_dir<span style="color:#f92672">=</span>/home/vagrant/Proyecto-integrado/podman/podman-compose --label com.docker.compose.project.config_files<span style="color:#f92672">=</span>/home/vagrant/Proyecto-integrado/podman/podman-compose/docker-compose.yml --label com.docker.compose.container-number<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --label com.docker.compose.service<span style="color:#f92672">=</span>wordpress -e WORDPRESS_DB_HOST<span style="color:#f92672">=</span>db -e WORDPRESS_DB_USER<span style="color:#f92672">=</span>user_wp -e WORDPRESS_DB_PASSWORD<span style="color:#f92672">=</span>asdasd -e WORDPRESS_DB_NAME<span style="color:#f92672">=</span>bd_wp --add-host wordpress:127.0.0.1 --add-host servidor_wp:127.0.0.1 --add-host db:127.0.0.1 --add-host servidor_mysql:127.0.0.1 --restart always wordpress

<span style="color:#75715e"># MySQL</span>
podman create --name<span style="color:#f92672">=</span>servidor_mysql --pod<span style="color:#f92672">=</span>wp_compose --label io.podman.compose.config-hash<span style="color:#f92672">=</span><span style="color:#ae81ff">123</span> --label io.podman.compose.project<span style="color:#f92672">=</span>wp_compose --label io.podman.compose.version<span style="color:#f92672">=</span>0.0.1 --label com.docker.compose.project<span style="color:#f92672">=</span>wp_compose --label com.docker.compose.project.working_dir<span style="color:#f92672">=</span>/home/vagrant/Proyecto-integrado/podman/podman-compose --label com.docker.compose.project.config_files<span style="color:#f92672">=</span>/home/vagrant/Proyecto-integrado/podman/podman-compose/docker-compose.yml --label com.docker.compose.container-number<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --label com.docker.compose.service<span style="color:#f92672">=</span>db -e MYSQL_DATABASE<span style="color:#f92672">=</span>bd_wp -e MYSQL_USER<span style="color:#f92672">=</span>user_wp -e MYSQL_PASSWORD<span style="color:#f92672">=</span>asdasd -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span>asdasd --add-host wordpress:127.0.0.1 --add-host servidor_wp:127.0.0.1 --add-host db:127.0.0.1 --add-host servidor_mysql:127.0.0.1 --restart always mariadb
</code></pre></div><p>En la carpeta del repositorio llamada <strong>podman-compose</strong> hay mas ficheros de ejemplo para montra escenarios con podman-compose.</p>

  
  </div>
</article>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  Francisco Javier Martín Núñez 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/sistemas">Sistemas</a></li>
         
        <li><a href="/seguridad">Seguridad</a></li>
         
        <li><a href="/servicios">Servicios</a></li>
         
        <li><a href="/implantacion">Implantacion</a></li>
         
        <li><a href="/bbdd">BBDD</a></li>
         
        <li><a href="/hlc">HLC</a></li>
         
        <li><a href="/proyecto-podman">Proyecto Podman</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
  
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
